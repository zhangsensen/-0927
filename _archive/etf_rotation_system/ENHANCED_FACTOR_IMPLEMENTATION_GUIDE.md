# å¢å¼ºå› å­ç³»ç»Ÿå®æ–½æŒ‡å—

## ğŸ¯ æ ¸å¿ƒæ”¹è¿›

### 1. **å› å­å¤šæ ·æ€§æå‡**
- **ä»8ä¸ªåŠ¨é‡å› å­ â†’ 15ä¸ªå¤šæ ·åŒ–å› å­**
- **5ä¸ªå› å­ç±»åˆ«**ï¼šåŠ¨é‡(4)ã€æŠ€æœ¯æŒ‡æ ‡(4)ã€æ³¢åŠ¨ç‡(3)ã€ä»·æ ¼ä½ç½®(2)ã€é‡ä»·å…³ç³»(2)
- **å› å­ç›¸å…³æ€§çº¦æŸ**ï¼šæœ€å¤§ç›¸å…³æ€§ä»0.75æ”¾å®½åˆ°0.8

### 2. **ç­›é€‰æ ‡å‡†ä¼˜åŒ–**
```yaml
åŸå§‹æ ‡å‡† â†’ å¢å¼ºæ ‡å‡†
IC >= 0.01 â†’ IC >= 0.005 (é™ä½50%)
IC_IR >= 0.08 â†’ IC_IR >= 0.05 (é™ä½37.5%)
p-value <= 0.05 â†’ p-value <= 0.1 (æ”¾å®½100%)
è¦†ç›–ç‡ >= 0.75 â†’ è¦†ç›–ç‡ >= 0.7 (å°å¹…é™ä½)
```

### 3. **å› å­æƒé‡åˆ†é…**
- **æ ¸å¿ƒå› å­** (IC >= 0.015, IR >= 0.1)ï¼šæƒé‡6-8%
- **ç ”ç©¶å› å­** (IC >= 0.005, IR >= 0.05)ï¼šæƒé‡6-7%
- **è¡¥å……å› å­** (IC >= 0.003, IR >= 0.03)ï¼šæƒé‡6%

## ğŸ“Š å®æ–½æ­¥éª¤

### Step 1: å¤‡ä»½ç°æœ‰ç³»ç»Ÿ
```bash
# å¤‡ä»½ç°æœ‰é…ç½®å’Œæ•°æ®
cp -r etf_rotation_system/data/results/panels etf_rotation_system/data/results/panels_backup
cp -r etf_rotation_system/data/results/screening etf_rotation_system/data/results/screening_backup
```

### Step 2: éƒ¨ç½²å¢å¼ºå› å­ç³»ç»Ÿ
```bash
# 1. å°†å¢å¼ºå› å­ä»£ç æ·»åŠ åˆ°ç°æœ‰ç³»ç»Ÿ
cp enhanced_factor_system.py etf_rotation_system/01_æ¨ªæˆªé¢å»ºè®¾/

# 2. æ›´æ–°é…ç½®æ–‡ä»¶
cp enhanced_factor_config.yaml etf_rotation_system/config/

# 3. ç”Ÿæˆæ–°çš„å¢å¼ºå› å­é¢æ¿
cd etf_rotation_system/01_æ¨ªæˆªé¢å»ºè®¾/
python enhanced_factor_system.py
```

### Step 3: è¿è¡Œå¢å¼ºç­›é€‰
```bash
cd etf_rotation_system/02_å› å­ç­›é€‰/
python run_etf_cross_section_configurable.py --config ../config/enhanced_factor_config.yaml
```

### Step 4: éªŒè¯ç»“æœ
```bash
# æ£€æŸ¥ç­›é€‰æŠ¥å‘Š
cat etf_rotation_system/data/results/enhanced_screening/enhanced_screening_*/enhanced_screening_report.txt

# éªŒè¯å› å­æ•°é‡å’Œåˆ†ç±»
python -c "
import json
import pandas as pd
import glob

# è¯»å–æœ€æ–°çš„ç­›é€‰ç»“æœ
latest_report = glob.glob('data/results/enhanced_screening/enhanced_screening_*/enhanced_screening_report.txt')[-1]
with open(latest_report) as f:
    print(f.read())
"
```

## ğŸ”§ æŠ€æœ¯è¦ç‚¹

### 1. **T+1åˆè§„æ€§**
æ‰€æœ‰å› å­è®¡ç®—ä¸¥æ ¼éµå®ˆT+1åŸåˆ™ï¼š
- ä½¿ç”¨ `shift(1)` è·å–æ˜¨æ—¥æ”¶ç›˜ä»·
- åœ¨Tæ—¶åˆ»åªèƒ½ä½¿ç”¨T-1åŠä¹‹å‰çš„æ•°æ®
- é¿å…æœªæ¥å‡½æ•°åå·®

### 2. **å› å­æ ‡å‡†åŒ–**
æ‰€æœ‰å› å­å€¼æ ‡å‡†åŒ–åˆ°[-1, 1]èŒƒå›´ï¼š
- `rsi_normalized = (rsi - 50) / 50`
- `bb_position = (position - 0.5) * 2`
- `williams_r = williams_r / 100`

### 3. **ç¼ºå¤±å€¼å¤„ç†**
- ä¸è¶³å†å²æ•°æ®æ—¶è¿”å›NaNæˆ–0
- ä½¿ç”¨ `fillna(0)` ç¡®ä¿æ•°æ®å®Œæ•´æ€§
- è®¾ç½® `min_history` è¦æ±‚é¿å…å°æ ·æœ¬åå·®

## ğŸ“ˆ é¢„æœŸæ”¹è¿›

### 1. **WFOè¿‡æ‹Ÿåˆç¼“è§£**
- å› å­æ•°é‡ï¼š8 â†’ 15 (+87.5%)
- å› å­ç±»åˆ«ï¼š1ç±»(åŠ¨é‡) â†’ 5ç±»(å¤šæ ·åŒ–)
- ç›¸å…³æ€§é™ä½ï¼šé€šè¿‡ç›¸å…³æ€§ä¼˜åŒ–ç®—æ³•

### 2. **ç­–ç•¥ç¨³å®šæ€§æå‡**
- **ç‰›å¸‚è¡¨ç°**ï¼šåŠ¨é‡å› å­ä¸»å¯¼ï¼ŒæŠ€æœ¯æŒ‡æ ‡å¢å¼º
- **ç†Šå¸‚è¡¨ç°**ï¼šæ³¢åŠ¨ç‡å’Œé£é™©å› å­æä¾›ä¿æŠ¤
- **éœ‡è¡å¸‚**ï¼šä»·æ ¼ä½ç½®å’Œé‡ä»·å…³ç³»å› å­æ”¹å–„æ‹©æ—¶

### 3. **ICåˆ†å¸ƒä¼˜åŒ–**
- **ICå‡å€¼**ï¼šé¢„æœŸä»0.025æå‡åˆ°0.035
- **IC_IR**ï¼šé¢„æœŸä»0.12æå‡åˆ°0.15
- **ICç¨³å®šæ€§**ï¼šå¤šå‘¨æœŸå› å­å¹³æ»‘è¡¨ç°

## âš ï¸ é£é™©æ§åˆ¶

### 1. **æ•°æ®è´¨é‡æ£€æŸ¥**
```python
# æ£€æŸ¥å› å­è¦†ç›–ç‡
coverage = factor_data.notna().mean()
if coverage < 0.7:
    print(f"è­¦å‘Šï¼šå› å­è¦†ç›–ç‡è¿‡ä½: {coverage}")

# æ£€æŸ¥å¼‚å¸¸å€¼
factor_stats = factor_data.describe()
outliers = factor_data[(factor_data > factor_stats.loc['75%'] + 1.5 * (factor_stats.loc['75%'] - factor_stats.loc['25%'])).any(axis=1)]
```

### 2. **å›æµ‹éªŒè¯**
```python
# æ ·æœ¬å¤–æµ‹è¯•
train_period = slice('2020-01-01', '2023-12-31')
test_period = slice('2024-01-01', '2025-10-24')

train_ic = calculate_ic(factor_data.loc[train_period])
test_ic = calculate_ic(factor_data.loc[test_period])

print(f"æ ·æœ¬å†…IC: {train_ic.mean():.4f}")
print(f"æ ·æœ¬å¤–IC: {test_ic.mean():.4f}")
```

### 3. **æ€§èƒ½ç›‘æ§**
- æ¯æ—¥å› å­å€¼åˆ†å¸ƒç›‘æ§
- ICè¡°å‡æƒ…å†µè·Ÿè¸ª
- å› å­æƒé‡åŠ¨æ€è°ƒæ•´
- å¸‚åœºåˆ¶åº¦å˜åŒ–å“åº”

## ğŸ”„ åç»­ä¼˜åŒ–

### 1. **æœºå™¨å­¦ä¹ å¢å¼º**
- éšæœºæ£®æ—å› å­é€‰æ‹©
- LASSOå›å½’æƒé‡ä¼˜åŒ–
- XGBoostéçº¿æ€§å› å­ç»„åˆ

### 2. **è‡ªé€‚åº”æœºåˆ¶**
- å¸‚åœºæ³¢åŠ¨ç‡è‡ªé€‚åº”æƒé‡
- å› å­ICåŠ¨æ€ç›‘æ§å’Œè°ƒæ•´
- è‡ªåŠ¨å› å­æ›¿æ¢æœºåˆ¶

### 3. **å®æ—¶ç›‘æ§**
- å› å­å¤±æ•ˆé¢„è­¦ç³»ç»Ÿ
- è‡ªåŠ¨åŒ–æ€§èƒ½æŠ¥å‘Š
- é£é™©æŒ‡æ ‡å®æ—¶ç›‘æ§

---

## ğŸ“ æ”¯æŒè”ç³»

å¦‚æœ‰å®æ–½é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æ•°æ®è·¯å¾„å’Œæ ¼å¼æ˜¯å¦æ­£ç¡®
2. é…ç½®æ–‡ä»¶å‚æ•°æ˜¯å¦åˆç†
3. ä¾èµ–åŒ…ç‰ˆæœ¬æ˜¯å¦å…¼å®¹
4. ç³»ç»Ÿèµ„æºæ˜¯å¦å……è¶³

**é¢„æœŸå®æ–½æ—¶é—´**ï¼š2-3å¤©
**é¢„æœŸæ”¹è¿›æ•ˆæœ**ï¼šWFOæ”¶ç›Šç‡æå‡20-30%ï¼Œç¨³å®šæ€§æ˜¾è‘—æ”¹å–„