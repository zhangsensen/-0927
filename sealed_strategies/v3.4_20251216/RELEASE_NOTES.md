# v3.4 Release Notes
**Release Date**: 2025-12-16  
**Version**: v3.4_20251216  
**Type**: éœ‡è¡å¸‚ç²¾é€‰åŒç­–ç•¥ï¼ˆProduction Readyï¼‰

---

## ğŸ¯ Summary

æœ¬ç‰ˆæœ¬æ˜¯åŸºäº**æœ€è¿‘ 60 å¤©äº¤æ˜“è®°å½•æ·±åº¦åˆ†æ**ï¼Œä» v3.3 çš„ 5 ç­–ç•¥ç»„åˆä¸­ç²¾é€‰å‡ºçš„**éœ‡è¡å¸‚æœ€ä¼˜åŒç­–ç•¥**ã€‚

### æ ¸å¿ƒå˜åŒ–
- âœ‚ï¸ **åˆ é™¤ 3 ä¸ªæ‹–æ²¹ç“¶ç­–ç•¥**ï¼ˆè¿‘ 60 å¤© -5% ~ -9%ï¼‰
- âœ… **ä¿ç•™ 2 ä¸ªæŠ—è·Œç­–ç•¥**ï¼ˆè¿‘ 60 å¤© -0.23%ï¼Œå‡ ä¹æŒå¹³ï¼‰
- ğŸ”¬ **æ–°å¢è¯¦ç»†äº¤æ˜“æ—¥å¿—åˆ†æ**ï¼ˆè¯†åˆ«å†›å·¥å‘ vs çº³æŒ‡åå¼¹çš„å…³é”®å·®å¼‚ï¼‰
- ğŸ“Š **å¼ºåŒ–é£æ§å»ºè®®**ï¼ˆQDII æŒä»“ä¸Šé™ã€åŒæ­¥å¤§è·Œç†”æ–­ï¼‰

---

## ğŸ“ˆ Performance Comparison

| Version | Strategies | Avg Return | Avg Sharpe | Avg MaxDD | Recent 60d |
|:--------|:-----------|:-----------|:-----------|:----------|:-----------|
| **v3.4** | **2** | **133.19%** | **1.24** | **14.70%** | **-0.23%** âœ… |
| v3.3 | 5 | 132.44% | 1.20 | 15.08% | **-2.85%** âŒ |
| v3.2 | 5 | 130.12% | 1.18 | 15.32% | N/A |

**å…³é”®è§‚å¯Ÿ**:
- **é•¿æœŸæ”¶ç›Š**: v3.4 ä¸ v3.3 åŸºæœ¬æŒå¹³ï¼ˆ+0.75ppï¼‰ï¼Œå› ä¸ºåˆ é™¤çš„ 3 ä¸ªç­–ç•¥é•¿æœŸè¡¨ç°ä¹Ÿä¸å·®
- **è¿‘æœŸæŠ—è·Œ**: v3.4 æ˜¾è‘—ä¼˜äº v3.3ï¼ˆ**+2.62pp**ï¼‰ï¼Œéœ‡è¡å¸‚é€‚é…èƒ½åŠ›æ›´å¼º

---

## ğŸ”„ What Changed from v3.3?

### 1. ç­–ç•¥æ•°é‡å‡å°‘ï¼ˆ5 â†’ 2ï¼‰

#### åˆ é™¤çš„ 3 ä¸ªç­–ç•¥ï¼ˆè¿‘ 60 å¤©è¡¨ç°ä¸ä½³ï¼‰
| Strategy | Factors | 60d Return | Reason |
|:---------|:--------|:-----------|:-------|
| **#1** | 6 å› å­ (å« VORTEX_14D) | **-5.44%** | 10-20 ä¹°å†›å·¥å‘ï¼ˆ512400ï¼‰ï¼Œäº 1.1% |
| **#3** | 6 å› å­ (å« VORTEX_14D) | **-9.17%** | åå¤æŠ„åº•é»„é‡‘ï¼ˆ518880ï¼‰ï¼Œè¢«éœ‡è¡ç»æ€ |
| **#5** | 6 å› å­ (å« VOL_RATIO_20D) | **-5.76%** | åŒæ ·è¸©å†›å·¥å‘ + é»„é‡‘å‡çªç ´ |

#### ä¿ç•™çš„ 2 ä¸ªç­–ç•¥ï¼ˆè¿‘ 60 å¤©æŠ—è·Œï¼‰
| Strategy | Factors | 60d Return | Key Strength |
|:---------|:--------|:-----------|:-------------|
| **#2** (now #1) | 4 å› å­ | **-0.23%** | 10-20 ä¹°çº³æŒ‡ï¼ˆ513100ï¼‰ï¼Œèµš 6.5% |
| **#4** (now #2) | 5 å› å­ | **-0.23%** | åŒä¸Š + PRICE_POSITION_120D è¿‡æ»¤å‡çªç ´ |

### 2. æ ¹å› åˆ†æå·¥å…·æ–°å¢

æ–°å¢ `scripts/analyze_recent_divergence.py`ï¼Œç”¨äºæ·±åº¦åˆ†æç­–ç•¥åˆ†æ­§ï¼š
- æå–æœ€è¿‘ N å¤©äº¤æ˜“è®°å½•
- ç»Ÿè®¡æŒä»“æ ‡çš„ä¹°å–é¢‘æ¬¡
- è¯†åˆ«"å…³é”®äº¤æ˜“"ï¼ˆå¦‚ 10-20 å†›å·¥ vs çº³æŒ‡ï¼‰

### 3. é£æ§å»ºè®®å¼ºåŒ–

æ–°å¢ä»¥ä¸‹ç›‘æ§æŒ‡æ ‡ï¼š
- **QDII æŒä»“ä¸Šé™**: > 50% æ‰‹åŠ¨å‡ä»“ 20%
- **åŒæ­¥å¤§è·Œç†”æ–­**: ä¸¤ç­–ç•¥å•æ—¥åŒæ—¶è·Œ > 2% â†’ æ¬¡æ—¥å‡ä»“ 30%
- **å‘¨åº¦å®¡è®¡**: æŒä»“é‡åˆåº¦ > 90% è¯´æ˜åˆ†æ•£å¤±æ•ˆ

---

## âš ï¸ Breaking Changes

### 1. é…ç½®æ–‡ä»¶è°ƒæ•´

`artifacts/production_candidates.csv` ç°åœ¨åªåŒ…å« 2 è¡Œï¼ˆåŸ 5 è¡Œï¼‰ï¼š
```csv
combo_key,total_return,sharpe_ratio,max_drawdown,win_rate,trades,avg_hold_days,recent_63d
"ADX_14D + OBV_SLOPE_10D + SHARPE_RATIO_20D + SLOPE_20D",136.52,1.26,15.47,50.79,252,9.2,-0.67
"ADX_14D + OBV_SLOPE_10D + PRICE_POSITION_120D + SHARPE_RATIO_20D + SLOPE_20D",129.85,1.22,13.93,49.42,257,9.0,-0.67
```

### 2. ä¿¡å·ç”Ÿæˆè„šæœ¬

å¦‚æœä¹‹å‰æœ‰è‡ªåŠ¨åŒ–æµç¨‹éå† 5 ä¸ªç­–ç•¥ï¼Œéœ€è¦æ”¹ä¸ºåªéå† 2 ä¸ªï¼š
```python
# v3.3 (æ—§)
for i in range(5):
    generate_signal(strategy_id=i)

# v3.4 (æ–°)
for i in range(2):
    generate_signal(strategy_id=i)
```

---

## ğŸš€ New Features

### 1. è¯¦ç»†äº¤æ˜“æ—¥å¿—åˆ†æ

`artifacts/PRODUCTION_REPORT.md` æ–°å¢ç« èŠ‚ï¼š
- **Recent Performance Analysis**: æœ€è¿‘ 60 å¤©é€ç¬”äº¤æ˜“è®°å½•
- **Most Traded ETFs**: ä¹°å–é¢‘æ¬¡ç»Ÿè®¡
- **Key Insights**: å…³é”®äº¤æ˜“å†³ç­–åˆ†æï¼ˆå¦‚ 10-20 å†›å·¥å‘ vs çº³æŒ‡åå¼¹ï¼‰

### 2. é£æ§å»ºè®®æ¸…å•

`artifacts/DEPLOYMENT_GUIDE.md` æ–°å¢ï¼š
- **æ—¥é¢‘ç›‘æ§æŒ‡æ ‡**: ç»„åˆæ—¥æ”¶ç›Šã€QDII æŒä»“å æ¯”ã€åŒæ­¥å¤§è·Œ
- **å‘¨åº¦å®¡è®¡**: æŒä»“é‡åˆåº¦ã€èƒœç‡
- **ç†”æ–­æœºåˆ¶**: å•æ—¥/è¿ç»­ 3 æ—¥è§¦å‘æ¡ä»¶

### 3. å¿«é€Ÿå‚è€ƒæ–‡æ¡£

æ–°å¢ `artifacts/QUICK_REFERENCE.md`ï¼ŒåŒ…å«ï¼š
- å› å­é€ŸæŸ¥è¡¨
- æŒä»“ç‰¹å¾ï¼ˆå¹³å‡æŒæœ‰æœŸã€æ¢æ‰‹ç‡ï¼‰
- å¸¸è§ FAQ

---

## ğŸ› Bug Fixes

### 1. `analyze_recent_divergence.py` å‚æ•°é€‚é…

**é—®é¢˜**: `generate_rebalance_schedule()` è°ƒç”¨æ—¶ç¼ºå°‘ `lookback` å‚æ•°  
**ä¿®å¤**: æ·»åŠ  `lookback=252`ï¼ˆä¸ BT ä¿æŒä¸€è‡´ï¼‰

### 2. BT è¿”å›å€¼è§£åŒ…

**é—®é¢˜**: `run_bt_backtest()` è¿”å› 4 å…ƒç»„ï¼Œä½†åªè§£åŒ… 3 ä¸ª  
**ä¿®å¤**: æ·»åŠ  `final_value` æ¥æ”¶ç¬¬ 4 ä¸ªè¿”å›å€¼

---

## ğŸ“¦ Migration Guide

### ä» v3.3 è¿ç§»åˆ° v3.4

#### Step 1: å¤‡ä»½ v3.3 ä¿¡å·ï¼ˆå¦‚æœæœ‰è¿è¡Œä¸­çš„ç­–ç•¥ï¼‰
```bash
cp -r signals/v3.3 signals/v3.3_backup_$(date +%Y%m%d)
```

#### Step 2: æ›´æ–°ä¿¡å·ç”Ÿæˆè„šæœ¬
```bash
# ä¿®æ”¹ç­–ç•¥éå†é€»è¾‘ï¼ˆ5 â†’ 2ï¼‰
vi scripts/daily_signal_generator.py
```

#### Step 3: è¿è¡Œ v3.4 å›æµ‹éªŒè¯
```bash
cd sealed_strategies/v3.4_20251216/locked
uv sync
uv run python scripts/batch_bt_backtest.py \
  --candidates ../artifacts/production_candidates.csv
```

#### Step 4: éƒ¨ç½²åˆ°ç”Ÿäº§ï¼ˆå¦‚æœå›æµ‹é€šè¿‡ï¼‰
```bash
# ç”Ÿæˆä»Šæ—¥ä¿¡å·
uv run python scripts/generate_today_signal.py \
  --combo "ADX_14D + OBV_SLOPE_10D + SHARPE_RATIO_20D + SLOPE_20D"

# æäº¤è®¢å•
uv run python scripts/submit_orders.py --signal signals/strategy1_today.json
```

---

## ğŸ”¬ Technical Details

### é€‰æ‹©é€»è¾‘ï¼ˆä¸ºä»€ä¹ˆæ˜¯è¿™ 2 ä¸ªï¼Ÿï¼‰

1. **æ•°æ®é©±åŠ¨**: ä¸æ˜¯æ‹è„‘è¢‹ï¼Œè€Œæ˜¯åŸºäºæœ€è¿‘ 60 å¤©å®é™…äº¤æ˜“è®°å½•
2. **å•ä¸€ç»´åº¦æ’åº**: ä¸æå¤æ‚åŠ æƒï¼Œç›´æ¥æŒ‰"è¿‘ 60 å¤©æ”¶ç›Š"æ’åº
3. **é˜ˆå€¼è¿‡æ»¤**: åˆ é™¤ < -5% çš„ç­–ç•¥ï¼ˆè®¤ä¸ºéœ‡è¡å¸‚ä¸é€‚é…ï¼‰

### å› å­é‡åˆåº¦åˆ†æ

| Strategy | ADX_14D | OBV_SLOPE_10D | SHARPE_RATIO_20D | SLOPE_20D | PRICE_POSITION_120D |
|:---------|:-------:|:-------------:|:----------------:|:---------:|:-------------------:|
| **#1** | âœ… | âœ… | âœ… | âœ… | âŒ |
| **#2** | âœ… | âœ… | âœ… | âœ… | âœ… |
| **Jaccard** | - | - | - | - | **0.80** |

**ç»“è®º**: é«˜åº¦åŒè´¨åŒ–ï¼ˆå› å­é‡åˆ 80%ï¼ŒæŒä»“é‡åˆ >80%ï¼‰ï¼Œ**ä¸æ˜¯çœŸå®åˆ†æ•£**ã€‚

---

## ğŸ“Š Backtest Alignment

| Metric | VEC | BT | Diff |
|:-------|:----|:---|:-----|
| Strategy #1 Return | 136.52% | 136.52% | **0.00pp** âœ… |
| Strategy #2 Return | 129.85% | 129.85% | **0.00pp** âœ… |
| Max Drawdown | 14.70% | 14.70% | **0.00pp** âœ… |

**å¯¹é½çŠ¶æ€**: å®Œç¾ï¼ˆæµ®ç‚¹ç²¾åº¦ç´¯ç§¯è¯¯å·® < 0.01ppï¼‰

---

## âš¡ Performance Notes

### ä¼˜åŠ¿åœºæ™¯
- âœ… **éœ‡è¡ç£¨åº•**: 2025Q4 è¡¨ç°ä¼˜å¼‚ï¼ˆ-0.23% vs å¤§ç›˜ -5%ï¼‰
- âœ… **æ”¿ç­–åº•ååå¼¹**: æå‰å¸ƒå±€çº³æŒ‡/ç§‘æŠ€ ETF
- âœ… **é¿å¼€å‡çªç ´**: ç®€æ´å› å­ç»„åˆä¸ä¼šåå¤æ­¢æŸ

### åŠ£åŠ¿åœºæ™¯
- âŒ **å•è¾¹è¶‹åŠ¿å¸‚**: 2020H2-2021H1 å¯èƒ½è·‘è¾“å•ç­–ç•¥
- âŒ **ç¾è‚¡æš´è·Œ**: 40% äº¤æ˜“ä¸º QDIIï¼Œæµ·å¤–å´©ç›˜ä¼šåŒæ­¥é‡åˆ›
- âŒ **é«˜æ³¢åŠ¨éœ‡è¡**: å¹³å‡æŒæœ‰ 9 å¤©ï¼Œäº¤æ˜“æˆæœ¬æ•æ„Ÿ

---

## ğŸ” Security & Integrity

### æ ¡éªŒå’Œï¼ˆé˜²ç¯¡æ”¹ï¼‰
æ‰€æœ‰å…³é”®æ–‡ä»¶å·²ç”Ÿæˆ SHA256 æ ¡éªŒå’Œï¼š
```bash
sha256sum -c CHECKSUMS.sha256
```

### å¯å¤ç°æ€§
- âœ… **Configs é”å®š**: `locked/configs/`
- âœ… **Scripts é”å®š**: `locked/scripts/`
- âœ… **Src é”å®š**: `locked/src/`
- âœ… **ä¾èµ–é”å®š**: `pyproject.toml` + `uv.lock`ï¼ˆä¸åœ¨å°æ¿åŒ…ä¸­ï¼Œéœ€è¦ `uv sync` ç”Ÿæˆï¼‰

---

## ğŸ“ Changelog (Detailed)

### Added
- âœ… `scripts/analyze_recent_divergence.py`ï¼ˆäº¤æ˜“åˆ†æ­§åˆ†æå·¥å…·ï¼‰
- âœ… `artifacts/QUICK_REFERENCE.md`ï¼ˆå¿«é€Ÿå‚è€ƒï¼‰
- âœ… `artifacts/DEPLOYMENT_GUIDE.md`ï¼ˆéƒ¨ç½²æŒ‡å—ï¼‰
- âœ… é£æ§å»ºè®®ç« èŠ‚ï¼ˆQDII ä¸Šé™ã€ç†”æ–­æœºåˆ¶ï¼‰

### Changed
- ğŸ”„ `artifacts/production_candidates.csv`: 5 ç­–ç•¥ â†’ 2 ç­–ç•¥
- ğŸ”„ `artifacts/PRODUCTION_REPORT.md`: æ–°å¢æœ€è¿‘ 60 å¤©äº¤æ˜“åˆ†æ
- ğŸ”„ `README.md`: æ›´æ–°å¿«é€Ÿå¼€å§‹æ­¥éª¤ï¼ˆé€‚é… 2 ç­–ç•¥ï¼‰

### Removed
- âŒ Strategy #1 (6 å› å­, è¿‘ 60d -5.44%)
- âŒ Strategy #3 (6 å› å­, è¿‘ 60d -9.17%)
- âŒ Strategy #5 (6 å› å­, è¿‘ 60d -5.76%)

### Fixed
- ğŸ› `analyze_recent_divergence.py`: ä¿®å¤ `generate_rebalance_schedule()` å‚æ•°é”™è¯¯
- ğŸ› `analyze_recent_divergence.py`: ä¿®å¤ `run_bt_backtest()` è¿”å›å€¼è§£åŒ…é”™è¯¯

---

## ğŸ”® Roadmap (Future Versions)

### v3.5 (è®¡åˆ’ä¸­)
- [ ] åŠ¨æ€å› å­æƒé‡ï¼ˆæ ¹æ®å¸‚åœºç¯å¢ƒè°ƒæ•´ï¼‰
- [ ] æ­¢æŸä¼˜åŒ–ï¼ˆéœ‡è¡å¸‚æ”¾å®½æ­¢æŸï¼Œè¶‹åŠ¿å¸‚æ”¶ç´§ï¼‰
- [ ] å¤šæ—¶é—´å‘¨æœŸéªŒè¯ï¼ˆ5 å¹´ / 3 å¹´ / 1 å¹´çª—å£ï¼‰

### v4.0 (æ„¿æ™¯)
- [ ] æœºå™¨å­¦ä¹ å› å­é€‰æ‹©ï¼ˆXGBoost / LightGBMï¼‰
- [ ] å®æ—¶ç›‘æ§ä»ªè¡¨ç›˜ï¼ˆGrafana + InfluxDBï¼‰
- [ ] è‡ªåŠ¨å†å¹³è¡¡ï¼ˆæ ¹æ®æŒä»“é‡åˆåº¦è§¦å‘ï¼‰

---

## ğŸ“ Support & Feedback

**æ–‡æ¡£**:
- å¿«é€Ÿå¼€å§‹: `README.md`
- å¤ç°æŒ‡å—: `REPRODUCE.md`
- è¯¦ç»†æŠ¥å‘Š: `artifacts/PRODUCTION_REPORT.md`

**é—®é¢˜åé¦ˆ**:
- æ£€æŸ¥ `locked/src/` æºç æ³¨é‡Š
- è¿è¡Œ `uv run pytest tests/ -v` éªŒè¯ç¯å¢ƒ

---

**Released by**: Quant Team  
**Review Date**: 2025-12-16  
**Next Review**: 2026-01-16 (æœˆåº¦å®¡è®¡)
